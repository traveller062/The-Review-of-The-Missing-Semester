
# Git
Git是免费，开源的**分布式版本控制系统**，高校处理从小到大的各种项目，具有廉价的本地库，暂存区域与多个工作分支等特征。

> git和Bash的命令行指令相承一脉
## 版本控制
  一种记录文件内容变化，以便将来查看特定版本修订情况的系统
- 可以记录文件修改历史记录，方便查看历史版本
- 方便版本切换
- 让个人开发到团队协作

### 集中式版本控制工具

CVS SVN VSS

都有一个单一的集中管理的服务器，保存所有文件的修订版本，协同工作的人们通过客户端连到这台服务器，取出最新文件或者提交更新

**特点**
- 每个人可以一定程度上看见他人进度
- 管理员容易掌握开发者的权限与管理版本控制系统，数据库容易维护
- 但如果中央服务器的单点故障，则无法实现协同工作

### 分布式版本控制系统
Git,Mercurial,Bazaar,Darcs

客户端提取的不是最新版本的文件快照，而是把代码仓库完整镜像下来，其他文件故障，事后可以用其他客户端本地的仓库进行恢复

**特点**
- 在服务器断网情况下可以进行开发
- 每个客户端保存的也都是整个完整的项目
- 利用远程库代替集中式的中央服务器

## 工作机制

| **区域名称** | **英文名称**          | **作用描述**                             |
| -------- | ----------------- | ------------------------------------ |
| **工作区**  | **Workspace**     | 你在设备上实际看到、编辑文件的文件夹。                  |
| **暂存区**  | **Index / Stage** | 一个临时区域，存放你准备提交的修改，相当于“购物车”。          |
| **本地仓库** | **Repository**    | 存储在 `.git` 目录中，记录了所有版本历史（离线可用）。      |
| **远程仓库** | **Remote**        | 托管在 GitHub/Gitee 上的服务器，用于多人协作。代码托管中心 |

**工作流**

1. **修改文件**：在工作区里新增、修改或删除了代码。
    
2. **暂存**：把改好的代码放进“购物车”。可以筛选哪些修改要提交。
    
3. **提交**：确认了购物车里的东西，给这次修改打个标签（提交信息），存入本地仓库。修改已经有了永久记录。
    
4. **推送**：你把本地的记录同步到云端，让其他人也能看到。
## 常用命令

| **分类**         | **指令**                                                            | **功能说明**                                                      |
| -------------- | ----------------------------------------------------------------- | ------------------------------------------------------------- |
| **基础配置**       | `git config --global user.name "姓名"`                              | 设置你的全局用户名                                                     |
|                | `git config --global user.email "邮箱"`                             | 设置你的全局邮箱                                                      |
| **获取仓库**       | `git init`                                                        | 在当前文件夹初始化一个新的本地仓库                                             |
|                | `git clone <url>`                                                 | 下载远程仓库（如 GitHub 项目）到本地                                        |
| **核心操作**       | `git status`                                                      | **查看状态**，确认哪些文件被修改或在暂存区                                       |
|                | `git add /git rm --cached <file>`                                 | 将所有修改添加到暂存区（准备提交）/删除暂存区文件                                     |
|                | `git commit -m "消息"`                                              | 提交暂存区内容到本地仓库，并添加版本说明                                          |
| **远程同步**       | `git pull`                                                        | 从远程获取代码并合并到本地（保持同步）                                           |
|                | `git push`                                                        | 将本地的提交推送到远程仓库（云端备份）                                           |
| **版本回退 (后悔药)** | **`git reset --hard <commit_id>`**                                | **强制回退**：将工作区彻底重置到某个版本，所有未提交的改动都会丢失                           |
|                | **`git reflog`**                                                  | **查看操作记录**：列出你所有的操作历史（包括被删除的提交和 reset 记录），通过它可以找回被 reset 掉的代码 |
| **查看与对比**      | `git log --oneline`/`git log`(显示详细信息                            ) | 查看简洁的提交历史记录                                                   |
|                | `git diff`                                                        | 查看当前修改与上次提交的具体差异                                              |
|                | `git reset HEAD <文件>`                                             | 撤销 `add` 操作，将文件从暂存区退回工作区                                      |
| **分支管理**       | `git branch -v`/ `git branch <filename>`                          | 查看本地分支情况/创建分支                                                 |
|                | `git checkout <分支名>`                                              | 切换到指定的分支（或 `git switch`）                                      |
|                | `git merge <分支名>`                                                 | 将指定分支的代码合并到当前分支                                               |

## 设置用户签名
设置用户签名和用户邮箱，**主要是区分不同操作者的身份**，在每一个版本提交信息中能够看到，确定提交人。

> **首次安装必须设置用户签名，否则无法提交代码**
> 
> **用户签名和邮箱与任何第三方账号没关系，邮箱可以是虚拟存在的，不会验证真实性**

```Bash
git config --global user.name name
git config --global useer.email email

#验证时去C盘里查找.gitconfig文件，里面有输入的信息记录
```
## 初始化本地库

初始化本地库意味着将指定文件夹变为一个git能够跟踪的版本仓库

进入Windows硬盘目录较为困难，选择在图形化界面进入项目根目录打开终端

```Bash
git init
```

Git会在当前目录下创建一个隐藏的.git文件夹

## 查看本地库状态

```Bash
git status
#当版本库为空时
On branch master
# 当前处于master分支上

No commits yet
# 还没有提交过任何版本

nothing to commit (create/copy files and use "git add" to track)
#暂存区里没有东西，请创建或复制文件进来，并使用git add来追踪
```

```Bash
#将文件从工作区添加到暂存区
git add <file>
#将文件从暂存区删除，但工作区内容不变，不会删去实体
git rm --cached <file>
```

## 提交本地库
```Bash
#将暂存区的文件提交本地库
git commit -m "日志信息" <file>
```

## 修改文件
```Bash
vim <file>
git add <file>
git commit -m "日志信息" <file>
#git reflog后会展示历史提交版本的序列号，head指向的master与master目前指向的版本

```

## 克隆本地库
```Bash
git clone <url>
# url为 HTTPS类url
#会拉取代码，初始化本地库，创建别名
```
## 查看日志

| **需求场景** | **命令**              | **效果说明**                        |
| -------- | ------------------- | ------------------------------- |
| **基础查看** | `git log`           | 显示最详细的信息（哈希值、作者、日期、提交说明）。       |
| **简洁查看** | `git log --oneline` | 每条记录只占一行，显示短哈希和提交说明，非常清爽。       |
| **查看统计** | `git log --stat`    | 除了基础信息，还会显示每次提交修改了哪些文件、增加了多少行。  |
| **查看详情** | `git log -p`        | 显示每次提交具体的代码差异（diff）。            |
| **限制数量** | `git log -n <数字>`   | 只显示最近的 n 条记录。例如 `git log -n 3`。 |

## 版本穿梭
```Bash
#使用指令后改变了master指向的版本，读取txt时直接读取当前指向txt版本
git reset --hard <file_id>
```


### 使用鼠标“划选即复制”（Git Bash 默认特性）


- **复制：** 用鼠标左键按住并**拖动选中**你想复制的数值或者字符串。在 Git Bash 的默认配置下，**只要你松开鼠标，选中的内容就已经自动进入剪贴板了**。
    
- **粘贴：** 点击**鼠标右键**即可直接粘贴，或者按 `Shift + Insert`（这是终端通用的粘贴快捷键）。****
### 实现版本快速穿梭

| **目标位置**      | **快捷表达**                  | **说明**                 |
| ------------- | ------------------------- | ---------------------- |
| **往回退 n 个版本** | `git reset --hard HEAD~n` | 例如 `HEAD~3` 代表回退 3 个版本 |
|               |                           |                        |
版本是指由提交顺序先后决定的，不是上一个操作的版本。给i他
## 分支


**优点**
在版本控制过程中，同时推进多个任务，为每个任务单独创建分支，将工作从开发主线上分离，不影响主线分支运行

分支可以理解为副本（分支底层是指针的引用）

**创建的分支会有主干master的所有文本的**


### 分支操作

| **操作分类**  | **命令**                      | **说明**                      |
| --------- | --------------------------- | --------------------------- |
| **查看**    | `git branch`                | 列出所有本地分支（当前分支前会有 `*` 号）     |
|           | `git branch -a/v`           | 查看**所有**分支（包括本地和远程）         |
| **创建**    | `git branch <name>`         | 创建一个名为 `<name>` 的新分支        |
| **切换**    | `git checkout <name>`       | 切换到指定分支                     |
|           | `git switch <name>`         | 切换分支（更现代、语义更明确的命令）          |
| **创建并切换** | `git checkout -b <name>`    | 创建新分支并立即切换过去                |
|           | `git switch -c <name>`      | 同上（新版语法）                    |
| **合并**    | `git merge <name>`          | 将 `<name>` 分支合并到**当前**所在的分支 |
| **删除**    | `git branch -d <name>`      | 删除本地分支（已合并的分支）              |
|           | `git branch -D <name>`      | 强制删除本地分支（未合并的分支也能删）         |
| **重命名**   | `git branch -m <old> <new>` | 给分支改名（大小写不敏感）               |
|           |                             |                             |

## 合并原理

Git 合并的是**三个具体的提交（Commit）快照**：


当你输入 `git merge <分支名>` 时，Git 会在后台锁定这三个点：

- **你的当下版本 **：你当前所在分支（比如 `master`）指向的那个**最新**提交。
    
- **对方的当下版本 **：你想要合过来的那个分支（比如 `HotFix`）指向的那个**最新**提交。
    
- **共同祖先 **：这两个分支在历史上“分家”时的那个提交点。

## 合并方式

| **特性**     | **正常合并 (Normal Merge)**   | **冲突合并 (Conflict Merge)**     |
| ---------- | ------------------------- | ----------------------------- |
| **触发条件**   | 不同分支修改了不同的文件，或同一文件的不同行。   | 两个分支同时修改了同一文件的**同一部分**。       |
| **Git 行为** | 自动合并代码，并可能自动创建一个新的“合并提交”。 | 合并中断，Git 标记冲突文件，等待人工处理。       |
| **结果**     | 合并直接完成，分支历史保持清晰。          | 必须手动解决并提交后，合并才算完成。            |
### 冲突合并
```bash
git merge master
#产生报错提示
Auto-merging attempt.txt
CONFLICT(content):Merge conflict in attempt.txt
Automatic merge failed; fix conflicts and then commit the result.
```
### 解决方案
**第一步：打开 `attempt.txt`


```
<<<<<<< HEAD
这是你当前分支 (HotFix) 的内容
=======
这是你想要合并过来的分支 (master) 的内容
>>>>>>> master
```

- `<<<<<<< HEAD` 到 `=======` 之间是现在的代码。
    
- `=======` 到 `>>>>>>> master` 之间是另一边的代码。
    

**第二步：修改**

1. 删掉 `<<<<<<<`, `=======`, `>>>>>>>` 标记。
    
2. 把内容修改为最终想要的样子。
    

**第三步： 在终端输入：


```Bash
git add attempt.txt
git commit -m "解决合并冲突"
```

## `Github`的合作方式

### 1. 共享仓库模式 (The Collaborator Model)

这种模式通常用于**小型开发团队**或**私有项目**。项目的所有者（Owner）在设置中将添加为 **Collaborator**（合作者）。

- **核心逻辑**：所有成员对同一个远程仓库拥有**直接推送（Push）权限**。
    
- **操作流**：
    
    1. Owner 把你加入合作者名单。
        
    2. 你直接 `git clone` 那个仓库。
        
    3. 本地开发 -> `commit` -> `push` 到主仓库。
        
- **优点**：流程简单，不需要来回切换仓库。
    
- **注意事项**：由于每个人都能改代码，通常需要配合 **分支保护策略 (Branch Protection)**，防止有人不小心把主分支（main/master）改乱了。
    

---

### 2. 派生模式 (The Fork and Pull Model)

适用于大公司和开源项目，不可能直接拿到推送权限的，这时就得用 Fork。

- **核心逻辑**：你先在 GitHub 上“克隆”一份项目的副本到你自己的账号下，改完后再申请合并回原项目。
    
- **操作流**：
    
    1. **Fork**：点击 GitHub 上的 "Fork" 按钮，把别人的项目复制一份到你的账号下。
        
    2. **Clone**：克隆**你账号下**的那个副本到本地。
        
    3. **Push**：在本地改完后，推送到你自己的远程副本。
        
    4. **Pull Request (PR)**：在 GitHub 页面上发起一个合并申请，请求原项目作者采纳代码。
        
- **优点**：极其安全。原项目作者可以审核（Review）每一行代码，决定是否合并。
    
- **特点**：权限在手，天下我有。你可以在自己的副本里随意折腾，不会影响原项目。



| **特性**   | **共享仓库模式 (Collaborator)** | **派生模式 (Fork & PR)**   |
| -------- | ------------------------- | ---------------------- |
| **写权限**  | 你拥有主仓库的直接写入权              | 你只有自己副本的写入权            |
| **适用对象** | 核心成员、信任的小团队               | 外部贡献者、开源社区、大厂跨部门协作     |
| **操作成本** | 低（直接 Push）                | 中（多了 Fork 和 PR 步骤）     |
| **代码审核** | 可选（通过分支限制强制要求）            | **强制**（必须通过 PR 审核才能合并） |
| **安全性**  | 依赖于对每个成员的信任               | 依赖于代码审核流程              |
## SSH免密登录

可以在国内环境下更稳定登录，同时不必在多次pull,push中多次登录

